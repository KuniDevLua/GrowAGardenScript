-- KUNI MABANGIS ON TOP
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

local espEnabled = true
local truePetMap = {}

local petTable = {
    ["Common Egg"] = { "Dog", "Bunny", "Golden Lab" },
    ["Uncommon Egg"] = { "Chicken", "Black Bunny", "Cat", "Deer" },
    ["Rare Egg"] = { "Pig", "Monkey", "Rooster", "Orange Tabby", "Spotted Deer" },
    ["Legendary Egg"] = { "Cow", "Polar Bear", "Sea Otter", "Turtle", "Silver Monkey" },
    ["Mythical Egg"] = { "Grey Mouse", "Brown Mouse", "Squirrel", "Red Fox", "Red Giant Ant" },
    ["Bug Egg"] = { "Snail", "Caterpillar", "Giant Ant", "Praying Mantis", "Dragonfly" },
    ["Bee Egg"] = { "Bee", "Honey Bee", "Bear Bee", "Petal Bee" },
    ["Anti Bee Egg"] = { "Wasp", "Tarantula Hawk", "Moth", "Butterfly", "Disco Bee" },
    ["Common Summer Egg"] = { "Starfish", "Seagull", "Crab" },
    ["Rare Summer Egg"] = { "Sea Turtle", "Flamingo", "Toucan", "Seal", "Orangutan" },
    ["Oasis Egg"] = { "Meerkat", "Sand Snake", "Axolotl" },
    ["Paradise Egg"] = { "Ostrich", "Peacock", "Capybara", "Mimic Octopus" },
    ["Dinosaur Egg"] = { "Raptor", "Triceratops", "Stegosaurus", "T-Rex", "Pterodactyl", "Brontosaurus" },
    ["Primal Egg"] = { "Spinosaurus", "Ankylosaurus", "Dilophosaurus", "Parasaurolophus", "Iguanodon" },
    ["Night Egg"] = { "Frog", "Hedgehog", "Mole", "Echo Frog", "Night Owl" },
    ["Zen Egg"] = { "Shiba Inu", "Nihonzaru", "Tanuki", "Tanchozuru", "Kappa", "Kitsune" },
    ["Gourmet Egg"] = { "Bagel Bunny", "Pancake Mole", "Sushi Bear", "Spaghetti Sloth", "French Fry Ferret" }
}

local function applyESP(model, petName)
    if model:FindFirstChild("PetBillboard") then model.PetBillboard:Destroy() end
    if model:FindFirstChild("ESPHighlight") then model.ESPHighlight:Destroy() end
    if not espEnabled then return end
    local base = model:FindFirstChildWhichIsA("BasePart") or model.PrimaryPart
    if not base then return end
    local billboard = Instance.new("BillboardGui", base)
    billboard.Name="PetBillboard"
    billboard.Size=UDim2.new(0,250,0,40)
    billboard.AlwaysOnTop=true
    billboard.StudsOffset=Vector3.new(0,4.5,0)
    local label=Instance.new("TextLabel",billboard)
    label.Size=UDim2.new(1,0,1,0)
    label.BackgroundTransparency=1
    label.Text=model.Name.." | "..petName
    label.TextScaled=true
    label.Font=Enum.Font.FredokaOne
    label.TextStrokeTransparency=0.3
    label.TextColor3=Color3.new(1,1,1)
    local highlight=Instance.new("Highlight",model)
    highlight.Name="ESPHighlight"
    highlight.FillColor=Color3.fromRGB(255,200,0)
    highlight.OutlineColor=Color3.fromRGB(255,255,255)
    highlight.FillTransparency=0.7
    highlight.DepthMode=Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Adornee=model
end

local function removeESP(model)
    if model:FindFirstChild("PetBillboard") then model.PetBillboard:Destroy() end
    if model:FindFirstChild("ESPHighlight") then model.ESPHighlight:Destroy() end
end

local function getNearbyEggs(radius)
    local eggs = {}
    local root = (player.Character or player.CharacterAdded:Wait()):WaitForChild("HumanoidRootPart")
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Model") and petTable[obj.Name] then
            local base = obj:FindFirstChildWhichIsA("BasePart") or obj.PrimaryPart
            if base then
                local dist = (base.Position - root.Position).Magnitude
                if dist <= radius then
                    if not truePetMap[obj] then
                        truePetMap[obj] = petTable[obj.Name][math.random(1,#petTable[obj.Name])]
                    end
                    table.insert(eggs, obj)
                end
            end
        end
    end
    return eggs
end

local function randomizeEggs()
    for _, egg in ipairs(getNearbyEggs(60)) do
        local pets = petTable[egg.Name]
        local chosen = pets[math.random(1,#pets)]
        truePetMap[egg] = chosen
        applyESP(egg, chosen)
    end
end

local function hatchEgg(egg)
    local petName = truePetMap[egg]
    if not petName then return end

    local eggPart = egg:FindFirstChildWhichIsA("BasePart") or egg.PrimaryPart
    if not eggPart then return end
    local eggPosition = eggPart.Position

    -- Destroy egg model
    egg:Destroy()

    -- Clone pet model from ReplicatedStorage
    local petModel
    if ReplicatedStorage:FindFirstChild("Pets") and ReplicatedStorage.Pets:FindFirstChild(petName) then
        petModel = ReplicatedStorage.Pets[petName]:Clone()
    else
        warn("No pet model found for: "..petName)
        return
    end

    petModel.Name = petName
    petModel.Parent = Workspace

    local petBase = petModel:FindFirstChildWhichIsA("BasePart") or petModel.PrimaryPart
    if petBase then
        petModel:SetPrimaryPartCFrame(CFrame.new(eggPosition) * CFrame.new(0, petBase.Size.Y/2, 0))
    end
end

-- GUI Setup
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "PetRandomizerGUI"

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 250, 0, 200)
frame.Position = UDim2.new(0, 25, 0, 100)
frame.BackgroundColor3 = Color3.fromRGB(40,40,50)
Instance.new("UICorner", frame).CornerRadius = UDim.new(0,16)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1,0,0,30)
title.Text = "üé≤ Pet Randomizer"
title.Font = Enum.Font.FredokaOne
title.TextSize = 20
title.TextColor3 = Color3.fromRGB(255,250,255)
title.BackgroundTransparency = 1

local pastelColors = {
    Color3.fromRGB(255,176,224),
    Color3.fromRGB(187,222,251),
    Color3.fromRGB(255,236,179),
    Color3.fromRGB(200,230,201),
    Color3.fromRGB(225,190,231)
}
local nextColor = 1
local function createButton(text, yPos)
    local btn = Instance.new("TextButton", frame)
    btn.Size = UDim2.new(1, -20, 0, 32)
    btn.Position = UDim2.new(0, 10, 0, yPos)
    btn.BackgroundColor3 = pastelColors[nextColor]
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.FredokaOne
    btn.TextSize = 14
    btn.Text = text
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
    nextColor = nextColor + 1
    if nextColor > #pastelColors then nextColor = 1 end
    return btn
end

local randomBtn = createButton("üé≤ Randomize Pets", 36)
randomBtn.MouseButton1Click:Connect(randomizeEggs)

local hatchBtn = createButton("üê£ Hatch Nearby Eggs", 72)
hatchBtn.MouseButton1Click:Connect(function()
    for _, egg in pairs(getNearbyEggs(60)) do
        hatchEgg(egg)
    end
end)

local toggleESPBtn = createButton("üîç Toggle ESP", 108)
toggleESPBtn.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    for _, egg in pairs(getNearbyEggs(60)) do
        if espEnabled then
            applyESP(egg, truePetMap[egg])
        else
            removeESP(egg)
        end
    end
end)
